# 买卖股票 dp 解法

和一般的 dp 一样，无非就是求边界+状态转移方程

### 边界

由于动态规划是自底向上的，所以边界一般就是第 0 天的状态值

## 状态转移方程

首先要确定在任意一天结束时的状态,然后使其由前一天的状态推出。下面举例讨论：

### 1. 任意交易-最大利润

第 i 天结束时状态：

dp[i][0]: 手中无股票  
dp[i][1]: 手中有股票

转移方程：

dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])  
dp[i][1] = max(dp[i-1][0]-prices[i], dp[i-1][1])

### 2. 任意交易-最大利润-含冷冻期

第 i 天结束时状态：

- 手中有股票：  
  dp[i][0]: 手中有股票
- 手中无股票  
   分为两种情况，就是在 i 天有没有卖出股票。为何要分呢？因为它影响下一天的状态。  
   dp[i][1]: 手中无股票，且在 i 天卖出的  
   dp[i][2]: 手中无股票，且不是在 i 天卖出的

转移方程：

dp[i][0] = max(dp[i-1][0], dp[i-1][2]-prices[i])  
dp[i][1] = dp[i-1][0] + prices[i]  
dp[i][2] = max(dp[i-1][1], dp[i-1][2])

### 3. 最多 k 笔交易-最大利润

第 i 天的状态：

- 手中无股票：  
  dp[i][0][j]: i 天结束时，进行了 j 次交易， 手中无股票，的 `最大利润` (包含三个变量：1. i 天;2：无股票；3：j 次交易 0<=j<=k)
- 手中有股票：  
  dp[i][1][j]: i 天结束时，进行了 j 次交易， 手中有股票， 的`最大利润`

状态转移方程：  
dp[i][0][j] = max{ dp[i-1][0][j], dp[i-1][1][j]+prices[i] } (0<=j<=k)  
dp[i][1][j] = max{ dp[i-1][0][j]-prices[i], dp[i-1][1][j] } (0<=j<=k)

每一天的最大值利润就是: max{ dp[i][0][0], dp[i][0][1], dp[i][0][2] ... dp[i][0][k] }

### 4. 任意交易-最大利润-含手续费

第 i 天：

dp[i][0] = max{ dp[i-1][0], dp[i-1][1]+prices[i]-fee }  
dp[i][1] = max{ dp[i-1][0]-prices[i], dp[i-1][1] }
